# ğŸš€ TODO - Fitur Baru Kontrakan Management

## ğŸ“‹ Fitur yang Akan Diimplementasikan

### 1. ğŸ’° Auto-Generate Kwitansi Digital
- [ ] Migration: `create_payment_receipts_table`
- [ ] Model: `PaymentReceipt.php`
- [ ] Controller: `PaymentReceiptController.php`
- [ ] View: `receipt-pdf.blade.php`
- [ ] Update `PaymentController@approve` - auto generate
- [ ] Route: `/admin/payments/{payment}/receipt`

### 2. ğŸ”„ Multi-Payment per Bulan
- [ ] Update `PaymentProof` model - partial payment logic
- [ ] Update `user/payments/create.blade.php` - show remaining
- [ ] Update `admin/payments/show.blade.php` - list all payments
- [ ] Update `AdminController` - dashboard calculation
- [ ] Update `UserController` - payment history

### 3. ğŸ‘¤ User Profile Lengkap
- [ ] Migration: `add_profile_photo_to_users_extended`
- [ ] Update `UsersExtended` model - fillable & casts
- [ ] Update `ProfileController` - photo upload
- [ ] Update `profile/edit.blade.php` - photo & emergency contact
- [ ] Update `user/dashboard.blade.php` - show photo
- [ ] Storage config for profile photos

### 4. ğŸ” Ganti Password (User)
- [ ] Update `ProfileController` - `updatePassword()` method
- [ ] Update `profile/edit.blade.php` - password section
- [ ] Route: `PATCH /profile/password`
- [ ] Validation: current, new, confirm password

### 5. ğŸ“§ Lupa Password (Reset via Email)
- [ ] Update `.env` - mail configuration
- [ ] Update `auth/forgot-password.blade.php` - styling
- [ ] Update `auth/reset-password.blade.php` - styling
- [ ] Test email with Mailtrap/Mailpit
- [ ] Routes already exist (Laravel Breeze)

---

## ğŸ¯ Progress Tracking

| Fitur | Status | Progress |
|-------|--------|----------|
| User Profile Lengkap | âœ… Done | 100% |
| Ganti Password | âœ… Done | 100% |
| Lupa Password | âœ… Done | 100% |
| Multi-Payment | âœ… Done | 100% |
| Kwitansi Digital | â³ Pending | 0% |

---

## ğŸ“ Notes
- Urutan: Profile â†’ Password â†’ Lupa Password â†’ Multi-Payment â†’ Kwitansi
- Estimasi: ~30-40 file changes
- Testing: Setiap fitur perlu di-test sebelum lanjut

## âœ… Completed Features Detail

### 1. User Profile Lengkap âœ…
- Migration: `2026_02_10_000000_add_profile_photo_to_users_extended.php` âœ…
- Model: `UsersExtended` - added `profile_photo`, `emergency_contact_name` âœ…
- Controller: `ProfileController` - photo upload & extended profile update âœ…
- Controller: `ProfileController@updatePhoto` - dedicated photo upload method âœ…
- Route: `POST /profile/photo` - separate route for photo upload âœ…
- View: `profile/partials/update-profile-information-form.blade.php` âœ…
- View: `user/dashboard.blade.php` - show profile photo âœ…
- View: `user/profile.blade.php` - complete profile page with forms âœ…
- View: `layouts/admin.blade.php` - navbar with profile photo âœ…
- View: `layouts/user.blade.php` - navbar with profile photo âœ…
- View: `admin/users/show.blade.php` - admin can see user profile photo âœ…
- View: `admin/users/index.blade.php` - profile photo in user list table âœ…
- View: `admin/dashboard.blade.php` - profile photo in tunggakan & recent payments âœ…
- View: `admin/payments/index.blade.php` - profile photo in payments list âœ… **BARU**
- View: `admin/payments/pending.blade.php` - profile photo in pending list âœ… **BARU**
- View: `admin/payments/show.blade.php` - profile photo in user info card âœ… **BARU**
- View: `home.blade.php` - profile photo in room occupants list âœ… **BARU**
- Controller: `HomeController` - added `profile_photo_url` to room occupants data âœ… **BARU**
- Storage link: `public/storage` â†’ `storage/app/public` âœ…
- **Note**: Jalankan `php artisan storage:link` jika foto tidak tampil

### 2. Ganti Password âœ…
- Controller: `ProfileController@updatePassword` âœ…
- Route: `PATCH /profile/password` âœ…
- View: `profile/partials/update-password-form.blade.php` âœ…
- Validation: current_password, password, password_confirmation âœ…

### 3. Lupa Password via Email âœ…
- View: `auth/forgot-password.blade.php` - D-TECT styling âœ…
- View: `auth/reset-password.blade.php` - D-TECT styling âœ…
- Routes: Laravel Breeze default âœ…
- Note: Configure `.env` mail settings for production

### 4. Multi-Payment per Bulan âœ…
- Model: `UsersExtended` - added `getTotalPaidForMonth()`, `getRemainingForMonth()`, `isFullyPaidForMonth()`, `getPaymentsForMonth()`, `getPaymentStatusForMonth()` âœ…
- Controller: `PaymentController@create` - send existingPayments to view âœ…
- Controller: `PaymentController@store` - validate amount doesn't exceed remaining âœ…
- View: `user/payments/create.blade.php` - show payment status card with real-time JS updates âœ…
- View: `admin/payments/show.blade.php` - show all payments for the period âœ…
- Feature: User can pay in multiple installments until monthly fee is fully paid âœ…
